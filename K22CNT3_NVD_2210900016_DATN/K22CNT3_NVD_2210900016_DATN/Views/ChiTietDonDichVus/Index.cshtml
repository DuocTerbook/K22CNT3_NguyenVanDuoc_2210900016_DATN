@model IEnumerable<K22CNT3_NVD_2210900016_DATN.Models.ChiTietDonDichVu>

@{
    ViewBag.Title = "Chi tiết đơn dịch vụ";
}

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet" />

<style>
    .page-title {
        font-weight: 700;
        color: #1f2937;
    }

    .main-card {
        border-radius: 18px;
        border: none;
        box-shadow: 0 10px 30px rgba(0,0,0,.12);
    }

    table thead {
        background: #f1f5f9;
    }

    .badge-money {
        background: #e0f2fe;
        color: #0369a1;
        font-weight: 600;
    }

    .action-btn a {
        margin-right: 4px;
    }
</style>

<div class="container-fluid py-4">

    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
            <h3 class="page-title">📋 Chi tiết đơn dịch vụ</h3>
            <small class="text-muted">Danh sách các dịch vụ / sản phẩm trong đơn</small>
        </div>

        <a href="@Url.Action("Create", new { donDichVuId = ViewBag.DonDichVuId })"
           class="btn btn-success">
            <i class="fas fa-plus me-1"></i> Thêm chi tiết
        </a>
    </div>

    <!-- MESSAGE -->
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show">
            <i class="fas fa-check-circle me-1"></i>
            @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <!-- TABLE -->
    <div class="card main-card">
        <div class="card-body table-responsive">

            <table class="table table-hover align-middle">
                <thead>
                    <tr>
                        <th>Số lượng</th>
                        <th>Đơn giá</th>
                        <th>Thành tiền</th>
                        <th>Thông số</th>
                        <th>Dịch vụ</th>
                        <th>Sản phẩm</th>
                        <th>Khách hàng</th>
                        <th class="text-center">Thao tác</th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <!-- SỐ LƯỢNG -->
                            <td>@(item.SoLuong ?? 0)</td>

                            <!-- ĐƠN GIÁ -->
                            <td>
                                <span class="badge badge-money">
                                    @string.Format("{0:N0} ₫", item.DonGia ?? 0)
                                </span>
                            </td>

                            <!-- THÀNH TIỀN -->
                            <td>
                                <strong class="text-danger">
                                    @string.Format("{0:N0} ₫", item.ThanhTien ?? 0)
                                </strong>
                            </td>

                            <!-- THÔNG SỐ -->
                            <td>
                                @(string.IsNullOrWhiteSpace(item.ThongSoKyThuat)
                                ? "Không có"
                                : item.ThongSoKyThuat)
                            </td>

                            <!-- DỊCH VỤ -->
                            <td>
                                @(item.DichVu != null ? item.DichVu.TenDichVu : "")
                            </td>

                            <!-- SẢN PHẨM -->
                            <td>
                                @(item.SanPham != null ? item.SanPham.TenSP : "")
                            </td>

                            <!-- KHÁCH HÀNG -->
                            <td>
                                @(item.DonDichVu != null ? item.DonDichVu.TenKhach : "")
                            </td>

                            <!-- THAO TÁC -->
                            <td class="text-center action-btn">
                                <a href="@Url.Action("Edit", new { id = item.ID_CTDonDV })"
                                   class="btn btn-sm btn-warning">
                                    <i class="fas fa-edit"></i>
                                </a>

                                <a href="@Url.Action("Details", new { id = item.ID_CTDonDV })"
                                   class="btn btn-sm btn-info text-white">
                                    <i class="fas fa-eye"></i>
                                </a>

                                <a href="@Url.Action("Delete", new { id = item.ID_CTDonDV })"
                                   class="btn btn-sm btn-danger"
                                   onclick="return confirm('Bạn có chắc muốn xóa?');">
                                    <i class="fas fa-trash"></i>
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>

            </table>

        </div>
    </div>

    <div class="mt-3">
        <a href="@Url.Action("Index", "DonDichVus")" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-1"></i> Quay lại đơn dịch vụ
        </a>
    </div>

</div>
